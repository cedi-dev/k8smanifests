{
   "annotations": {
     "list": [
       {
         "builtIn": 1,
         "datasource": {
           "type": "grafana",
           "uid": "-- Grafana --"
         },
         "enable": true,
         "hide": true,
         "iconColor": "rgba(0, 211, 255, 1)",
         "name": "Annotations & Alerts",
         "type": "dashboard"
       }
     ]
   },
   "editable": true,
   "fiscalYearStartMonth": 0,
   "graphTooltip": 0,
   "links": [
     {
       "asDropdown": true,
       "icon": "external link",
       "includeVars": true,
       "keepTime": true,
       "tags": [
         "mimir"
       ],
       "targetBlank": false,
       "title": "Mimir dashboards",
       "type": "dashboards"
     }
   ],
   "liveNow": false,
   "panels": [
     {
       "collapsed": false,
       "datasource": {
         "type": "prometheus",
         "uid": "mimir-cedi"
       },
       "gridPos": {
         "h": 1,
         "w": 24,
         "x": 0,
         "y": 0
       },
       "id": 23,
       "panels": [],
       "targets": [
         {
           "datasource": {
             "type": "prometheus",
             "uid": "mimir-cedi"
           },
           "refId": "A"
         }
       ],
       "title": "Summary",
       "type": "row"
     },
     {
       "aliasColors": {
         "completed": "#7EB26D",
         "failed": "#E24D42",
         "started": "#34CCEB"
       },
       "bars": true,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "description": "### Per-instance runs\nNumber of times a compactor instance triggers a compaction across all tenants that it manages.\n\n",
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 10,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 0,
         "y": 1
       },
       "hiddenSeries": false,
       "id": 1,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": false,
       "linewidth": 0,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": true,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(cortex_compactor_runs_started_total{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "started",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(cortex_compactor_runs_completed_total{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "completed",
           "refId": "B",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(cortex_compactor_runs_failed_total{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "failed",
           "refId": "C",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Per-instance runs / sec",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ops",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "type": "prometheus",
         "uid": "$datasource"
       },
       "description": "### Tenants compaction progress\nIn a multi-tenant cluster, display the progress of tenants that are compacted while compaction is running.\nReset to <tt>0</tt> after the compaction run is completed for all tenants in the shard.\n\n",
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 6,
         "y": 1
       },
       "hiddenSeries": false,
       "id": 2,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "editorMode": "code",
           "expr": "sum by (pod) (\n(\n  cortex_compactor_tenants_processing_succeeded{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"} +\n  cortex_compactor_tenants_processing_failed{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"} +\n  cortex_compactor_tenants_skipped{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}\n)\n/\ncortex_compactor_tenants_discovered{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}\n)",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{pod}}",
           "range": true,
           "refId": "A",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Tenants compaction progress",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "percentunit",
           "logBase": 1,
           "max": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "description": "### Longest time since last successful run\nDisplays the amount of time since the most recent successful execution\nof the compactor.\nThe value shown will be for the compactor replica that has the longest time since its\nlast successful run.\nThe table to the right shows a summary for all compactor replicas.\n\nIf there is no time value, one of the following messages might appear:\n\n- If you see \"No compactor data\" in this panel, that means that no compactors are active yet.\n\n- If you see \"No successful runs\" in this panel, that means that compactors are active, but none\n  of them were successfully executed yet.\n\nThese might be expected - for example, if you just recently restarted your compactors,\nthey might not have had a chance to complete their first compaction run.\nHowever, if these messages persist, you should check the health of your compactors.\n\n",
       "fieldConfig": {
         "defaults": {
           "color": {
             "mode": "thresholds"
           },
           "decimals": 1,
           "mappings": [],
           "noValue": "No compactor data",
           "thresholds": {
             "mode": "absolute",
             "steps": []
           },
           "unit": "s",
           "unitScale": true
         },
         "overrides": [
           {
             "matcher": {
               "id": "byName",
               "options": "Last run"
             },
             "properties": [
               {
                 "id": "mappings",
                 "value": [
                   {
                     "options": {
                       "from": "-Infinity",
                       "result": {
                         "color": "text",
                         "text": "No successful runs since startup yet"
                       },
                       "to": 0
                     },
                     "type": "range"
                   }
                 ]
               },
               {
                 "id": "color",
                 "value": {
                   "mode": "thresholds"
                 }
               },
               {
                 "id": "thresholds",
                 "value": {
                   "mode": "absolute",
                   "steps": [
                     {
                       "color": "green",
                       "value": null
                     },
                     {
                       "color": "yellow",
                       "value": 7200
                     },
                     {
                       "color": "orange",
                       "value": 21600
                     },
                     {
                       "color": "red",
                       "value": 43200
                     }
                   ]
                 }
               }
             ]
           }
         ]
       },
       "fill": 1,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 12,
         "y": 1
       },
       "id": 3,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "colorMode": "value",
         "graphMode": "area",
         "justifyMode": "auto",
         "orientation": "auto",
         "reduceOptions": {
           "calcs": [
             "first"
           ],
           "fields": "/^Last run$/",
           "values": false
         },
         "showPercentChange": false,
         "textMode": "value",
         "wideLayout": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "max by(pod)\n(\n  (time() * (max_over_time(cortex_compactor_last_successful_run_timestamp_seconds{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[1h]) !=bool 0))\n  -\n  max_over_time(cortex_compactor_last_successful_run_timestamp_seconds{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[1h])\n)\n",
           "format": "table",
           "instant": true,
           "interval": "",
           "legendFormat": "",
           "refId": "A"
         }
       ],
       "thresholds": [],
       "title": "Longest time since last successful run",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "transformations": [
         {
           "id": "organize",
           "options": {
             "renameByName": {
               "Value": "Last run",
               "pod": "Compactor"
             }
           }
         },
         {
           "id": "sortBy",
           "options": {
             "sort": [
               {
                 "desc": true,
                 "field": "Last run"
               }
             ]
           }
         }
       ],
       "type": "stat",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "short",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ]
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "description": "### Last successful run per-compactor replica\nDisplays the compactor replicas, and for each, shows how long it has been since\nits last successful compaction run.\n\nThe value in the status column is based on how long it has been since the last successful compaction.\n\n- Okay: less than 2 hours\n- Delayed: more than 2 hours\n- Late: more than 6 hours\n- Very late: more than 12 hours\n\nIf the status of any compactor replicas are *Late* or *Very late*, check their health.\n\n",
       "fieldConfig": {
         "defaults": {
           "custom": {
             "align": "auto",
             "cellOptions": {
               "type": "auto"
             },
             "inspect": false
           },
           "mappings": [],
           "thresholds": {
             "mode": "absolute",
             "steps": [
               {
                 "color": "green",
                 "value": null
               },
               {
                 "color": "red",
                 "value": 80
               }
             ]
           },
           "unitScale": true
         },
         "overrides": [
           {
             "matcher": {
               "id": "byName",
               "options": "Status"
             },
             "properties": [
               {
                 "id": "custom.cellOptions",
                 "value": {
                   "mode": "gradient",
                   "type": "color-background"
                 }
               },
               {
                 "id": "mappings",
                 "value": [
                   {
                     "options": {
                       "from": "-Infinity",
                       "result": {
                         "color": "transparent",
                         "text": "N/A"
                       },
                       "to": 0
                     },
                     "type": "range"
                   },
                   {
                     "options": {
                       "from": 0,
                       "result": {
                         "color": "green",
                         "text": "Ok"
                       },
                       "to": 7200
                     },
                     "type": "range"
                   },
                   {
                     "options": {
                       "from": 7200,
                       "result": {
                         "color": "yellow",
                         "text": "Delayed"
                       },
                       "to": 21600
                     },
                     "type": "range"
                   },
                   {
                     "options": {
                       "from": 21600,
                       "result": {
                         "color": "orange",
                         "text": "Late"
                       },
                       "to": 43200
                     },
                     "type": "range"
                   },
                   {
                     "options": {
                       "from": 43200,
                       "result": {
                         "color": "red",
                         "text": "Very late"
                       },
                       "to": "Infinity"
                     },
                     "type": "range"
                   },
                   {
                     "options": {
                       "match": "null+nan",
                       "result": {
                         "color": "transparent",
                         "text": "Unknown"
                       }
                     },
                     "type": "special"
                   }
                 ]
               },
               {
                 "id": "custom.width",
                 "value": 86
               },
               {
                 "id": "custom.align",
                 "value": "center"
               }
             ]
           },
           {
             "matcher": {
               "id": "byName",
               "options": "Last run"
             },
             "properties": [
               {
                 "id": "unit",
                 "value": "s"
               },
               {
                 "id": "custom.width",
                 "value": 74
               },
               {
                 "id": "mappings",
                 "value": [
                   {
                     "options": {
                       "from": "-Infinity",
                       "result": {
                         "text": "Never"
                       },
                       "to": 0
                     },
                     "type": "range"
                   }
                 ]
               }
             ]
           }
         ]
       },
       "fill": 1,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 18,
         "y": 1
       },
       "id": 4,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "cellHeight": "sm",
         "footer": {
           "countRows": false,
           "fields": "",
           "reducer": [
             "sum"
           ],
           "show": false
         },
         "showHeader": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "max by(pod)\n(\n  (time() * (max_over_time(cortex_compactor_last_successful_run_timestamp_seconds{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[1h]) !=bool 0))\n  -\n  max_over_time(cortex_compactor_last_successful_run_timestamp_seconds{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[1h])\n)\n",
           "format": "table",
           "instant": true,
           "intervalFactor": 2,
           "legendFormat": "Last run",
           "refId": "A",
           "step": 10
         }
       ],
       "thresholds": [],
       "title": "Last successful run per-compactor replica",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "transformations": [
         {
           "id": "organize",
           "options": {
             "renameByName": {
               "Value": "Last run",
               "pod": "Compactor"
             }
           }
         },
         {
           "id": "sortBy",
           "options": {
             "sort": [
               {
                 "desc": true,
                 "field": "Last run"
               }
             ]
           }
         },
         {
           "id": "calculateField",
           "options": {
             "alias": "One",
             "binary": {
               "left": "Last run",
               "operator": "/",
               "right": "Last run"
             },
             "mode": "binary",
             "replaceFields": false
           }
         },
         {
           "id": "calculateField",
           "options": {
             "alias": "Status",
             "binary": {
               "left": "Last run",
               "operator": "*",
               "right": "One"
             },
             "mode": "binary",
             "replaceFields": false
           }
         },
         {
           "id": "filterFieldsByName",
           "options": {
             "include": {
               "names": [
                 "Compactor",
                 "Last run",
                 "Status"
               ]
             }
           }
         }
       ],
       "type": "table",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "short",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ]
     },
     {
       "collapsed": false,
       "datasource": {
         "type": "prometheus",
         "uid": "mimir-cedi"
       },
       "gridPos": {
         "h": 1,
         "w": 24,
         "x": 0,
         "y": 8
       },
       "id": 24,
       "panels": [],
       "targets": [
         {
           "datasource": {
             "type": "prometheus",
             "uid": "mimir-cedi"
           },
           "refId": "A"
         }
       ],
       "type": "row"
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "description": "### TSDB compactions / sec\nRate of TSDB compactions. Single TSDB compaction takes one or more input blocks and produces one or more (during \"split\" phase) output blocks.\n\n",
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 0,
         "y": 9
       },
       "hiddenSeries": false,
       "id": 5,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(prometheus_tsdb_compactions_total{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "compactions",
           "refId": "A",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "TSDB compactions / sec",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ops",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "description": "### TSDB compaction duration\nDisplay the amount of time that it has taken to run a single TSDB compaction.\n\n",
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 12,
         "y": 9
       },
       "hiddenSeries": false,
       "id": 6,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.99, sum(rate(prometheus_tsdb_compaction_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "99th Percentile",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.50, sum(rate(prometheus_tsdb_compaction_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "50th Percentile",
           "refId": "B",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(prometheus_tsdb_compaction_duration_seconds_sum{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval])) * 1e3 / sum(rate(prometheus_tsdb_compaction_duration_seconds_count{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "Average",
           "refId": "C",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "TSDB compaction duration",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ms",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "collapsed": false,
       "datasource": {
         "type": "prometheus",
         "uid": "mimir-cedi"
       },
       "gridPos": {
         "h": 1,
         "w": 24,
         "x": 0,
         "y": 16
       },
       "id": 25,
       "panels": [],
       "targets": [
         {
           "datasource": {
             "type": "prometheus",
             "uid": "mimir-cedi"
           },
           "refId": "A"
         }
       ],
       "type": "row"
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 0,
         "y": 17
       },
       "hiddenSeries": false,
       "id": 7,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "avg(max by(user) (cortex_bucket_blocks_count{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "avg",
           "refId": "A",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Average blocks / tenant",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "short",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "description": "### Tenants with largest number of blocks\nThe 10 tenants with the largest number of blocks.\n\n",
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 12,
         "y": 17
       },
       "hiddenSeries": false,
       "id": 8,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "topk(10, max by(user) (cortex_bucket_blocks_count{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{user}}",
           "refId": "A",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Tenants with largest number of blocks",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "short",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "collapsed": false,
       "datasource": {
         "type": "prometheus",
         "uid": "mimir-cedi"
       },
       "gridPos": {
         "h": 1,
         "w": 24,
         "x": 0,
         "y": 24
       },
       "id": 26,
       "panels": [],
       "targets": [
         {
           "datasource": {
             "type": "prometheus",
             "uid": "mimir-cedi"
           },
           "refId": "A"
         }
       ],
       "title": "Garbage collector",
       "type": "row"
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 0,
         "y": 25
       },
       "hiddenSeries": false,
       "id": 9,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(cortex_compactor_blocks_marked_for_deletion_total{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))\n",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "blocks",
           "refId": "A",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Blocks marked for deletion / sec",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ops",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {
         "failed": "#E24D42",
         "successful": "#7EB26D"
       },
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 10,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 12,
         "y": 25
       },
       "hiddenSeries": false,
       "id": 10,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 0,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": true,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(cortex_compactor_blocks_cleaned_total{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))\n",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "successful",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(cortex_compactor_block_cleanup_failures_total{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))\n",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "failed",
           "refId": "B",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Blocks deletions / sec",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ops",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "collapsed": false,
       "datasource": {
         "type": "prometheus",
         "uid": "mimir-cedi"
       },
       "gridPos": {
         "h": 1,
         "w": 24,
         "x": 0,
         "y": 32
       },
       "id": 27,
       "panels": [],
       "targets": [
         {
           "datasource": {
             "type": "prometheus",
             "uid": "mimir-cedi"
           },
           "refId": "A"
         }
       ],
       "title": "Metadata sync",
       "type": "row"
     },
     {
       "aliasColors": {
         "failed": "#E24D42",
         "successful": "#7EB26D"
       },
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 10,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 0,
         "y": 33
       },
       "hiddenSeries": false,
       "id": 11,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 0,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": true,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(cortex_compactor_meta_syncs_total{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))\n-\nsum(rate(cortex_compactor_meta_sync_failures_total{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))\n",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "successful",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(cortex_compactor_meta_sync_failures_total{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))\n",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "failed",
           "refId": "B",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Metadata syncs / sec",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ops",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 12,
         "y": 33
       },
       "hiddenSeries": false,
       "id": 12,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.99, sum(rate(cortex_compactor_meta_sync_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "99th Percentile",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.50, sum(rate(cortex_compactor_meta_sync_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "50th Percentile",
           "refId": "B",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(cortex_compactor_meta_sync_duration_seconds_sum{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval])) * 1e3 / sum(rate(cortex_compactor_meta_sync_duration_seconds_count{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "Average",
           "refId": "C",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Metadata sync duration",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ms",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "collapsed": false,
       "datasource": {
         "type": "prometheus",
         "uid": "mimir-cedi"
       },
       "gridPos": {
         "h": 1,
         "w": 24,
         "x": 0,
         "y": 40
       },
       "id": 28,
       "panels": [],
       "targets": [
         {
           "datasource": {
             "type": "prometheus",
             "uid": "mimir-cedi"
           },
           "refId": "A"
         }
       ],
       "title": "Object Store",
       "type": "row"
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 10,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 0,
         "y": 41
       },
       "hiddenSeries": false,
       "id": 13,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 0,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": true,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum by(operation) (rate(thanos_objstore_bucket_operations_total{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{operation}}",
           "refId": "A",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Operations / sec",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "reqps",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 6,
         "y": 41
       },
       "hiddenSeries": false,
       "id": 14,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum by(operation) (rate(thanos_objstore_bucket_operation_failures_total{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\"}[$__rate_interval])) / sum by(operation) (rate(thanos_objstore_bucket_operations_total{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{operation}}",
           "refId": "A",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Error rate",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "percentunit",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 12,
         "y": 41
       },
       "hiddenSeries": false,
       "id": 15,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.99, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"attributes\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "99th Percentile",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.50, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"attributes\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "50th Percentile",
           "refId": "B",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(thanos_objstore_bucket_operation_duration_seconds_sum{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"attributes\"}[$__rate_interval])) * 1e3 / sum(rate(thanos_objstore_bucket_operation_duration_seconds_count{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"attributes\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "Average",
           "refId": "C",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Latency of op: Attributes",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ms",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 18,
         "y": 41
       },
       "hiddenSeries": false,
       "id": 16,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.99, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"exists\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "99th Percentile",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.50, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"exists\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "50th Percentile",
           "refId": "B",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(thanos_objstore_bucket_operation_duration_seconds_sum{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"exists\"}[$__rate_interval])) * 1e3 / sum(rate(thanos_objstore_bucket_operation_duration_seconds_count{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"exists\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "Average",
           "refId": "C",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Latency of op: Exists",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ms",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "collapsed": false,
       "datasource": {
         "type": "prometheus",
         "uid": "mimir-cedi"
       },
       "gridPos": {
         "h": 1,
         "w": 24,
         "x": 0,
         "y": 48
       },
       "id": 29,
       "panels": [],
       "targets": [
         {
           "datasource": {
             "type": "prometheus",
             "uid": "mimir-cedi"
           },
           "refId": "A"
         }
       ],
       "type": "row"
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 0,
         "y": 49
       },
       "hiddenSeries": false,
       "id": 17,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.99, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"get\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "99th Percentile",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.50, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"get\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "50th Percentile",
           "refId": "B",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(thanos_objstore_bucket_operation_duration_seconds_sum{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"get\"}[$__rate_interval])) * 1e3 / sum(rate(thanos_objstore_bucket_operation_duration_seconds_count{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"get\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "Average",
           "refId": "C",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Latency of op: Get",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ms",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 6,
         "y": 49
       },
       "hiddenSeries": false,
       "id": 18,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.99, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"get_range\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "99th Percentile",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.50, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"get_range\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "50th Percentile",
           "refId": "B",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(thanos_objstore_bucket_operation_duration_seconds_sum{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"get_range\"}[$__rate_interval])) * 1e3 / sum(rate(thanos_objstore_bucket_operation_duration_seconds_count{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"get_range\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "Average",
           "refId": "C",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Latency of op: GetRange",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ms",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 12,
         "y": 49
       },
       "hiddenSeries": false,
       "id": 19,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.99, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"upload\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "99th Percentile",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.50, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"upload\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "50th Percentile",
           "refId": "B",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(thanos_objstore_bucket_operation_duration_seconds_sum{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"upload\"}[$__rate_interval])) * 1e3 / sum(rate(thanos_objstore_bucket_operation_duration_seconds_count{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"upload\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "Average",
           "refId": "C",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Latency of op: Upload",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ms",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 6,
         "x": 18,
         "y": 49
       },
       "hiddenSeries": false,
       "id": 20,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.99, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"delete\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "99th Percentile",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.50, sum(rate(thanos_objstore_bucket_operation_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"delete\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "50th Percentile",
           "refId": "B",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(thanos_objstore_bucket_operation_duration_seconds_sum{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"delete\"}[$__rate_interval])) * 1e3 / sum(rate(thanos_objstore_bucket_operation_duration_seconds_count{cluster=~\"$cluster\", namespace=~\"$namespace\",component=\"compactor\",operation=\"delete\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "Average",
           "refId": "C",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Latency of op: Delete",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ms",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "collapsed": false,
       "datasource": {
         "type": "prometheus",
         "uid": "mimir-cedi"
       },
       "gridPos": {
         "h": 1,
         "w": 24,
         "x": 0,
         "y": 56
       },
       "id": 30,
       "panels": [],
       "targets": [
         {
           "datasource": {
             "type": "prometheus",
             "uid": "mimir-cedi"
           },
           "refId": "A"
         }
       ],
       "title": "Key-value store for compactors ring",
       "type": "row"
     },
     {
       "aliasColors": {
         "1xx": "#EAB839",
         "2xx": "#7EB26D",
         "3xx": "#6ED0E0",
         "4xx": "#EF843C",
         "5xx": "#E24D42",
         "error": "#E24D42",
         "success": "#7EB26D"
       },
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 10,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 0,
         "y": 57
       },
       "hiddenSeries": false,
       "id": 21,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 0,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": true,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum by (status) (\n  label_replace(label_replace(rate(cortex_kv_request_duration_seconds_count{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\", kv_name=~\".+\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-z]+)\"))\n",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "{{status}}",
           "refId": "A",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Requests / sec",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "reqps",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     },
     {
       "aliasColors": {},
       "bars": false,
       "dashLength": 10,
       "dashes": false,
       "datasource": {
         "uid": "$datasource"
       },
       "fieldConfig": {
         "defaults": {
           "unitScale": true
         },
         "overrides": []
       },
       "fill": 1,
       "fillGradient": 0,
       "gridPos": {
         "h": 7,
         "w": 12,
         "x": 12,
         "y": 57
       },
       "hiddenSeries": false,
       "id": 22,
       "legend": {
         "avg": false,
         "current": false,
         "max": false,
         "min": false,
         "show": true,
         "total": false,
         "values": false
       },
       "lines": true,
       "linewidth": 1,
       "links": [],
       "nullPointMode": "null as zero",
       "options": {
         "alertThreshold": true
       },
       "percentage": false,
       "pluginVersion": "10.3.3",
       "pointradius": 5,
       "points": false,
       "renderer": "flot",
       "seriesOverrides": [],
       "spaceLength": 10,
       "stack": false,
       "steppedLine": false,
       "targets": [
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.99, sum(rate(cortex_kv_request_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\", kv_name=~\".+\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "99th Percentile",
           "refId": "A",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "histogram_quantile(0.50, sum(rate(cortex_kv_request_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\", kv_name=~\".+\"}[$__rate_interval])) by (le)) * 1e3",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "50th Percentile",
           "refId": "B",
           "step": 10
         },
         {
           "datasource": {
             "uid": "$datasource"
           },
           "expr": "sum(rate(cortex_kv_request_duration_seconds_sum{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\", kv_name=~\".+\"}[$__rate_interval])) * 1e3 / sum(rate(cortex_kv_request_duration_seconds_count{cluster=~\"$cluster\", job=~\"($namespace)/((compactor.*|cortex|mimir|mimir-backend.*))\", kv_name=~\".+\"}[$__rate_interval]))",
           "format": "time_series",
           "intervalFactor": 2,
           "legendFormat": "Average",
           "refId": "C",
           "step": 10
         }
       ],
       "thresholds": [],
       "timeRegions": [],
       "title": "Latency",
       "tooltip": {
         "shared": false,
         "sort": 0,
         "value_type": "individual"
       },
       "type": "graph",
       "xaxis": {
         "mode": "time",
         "show": true,
         "values": []
       },
       "yaxes": [
         {
           "format": "ms",
           "logBase": 1,
           "min": 0,
           "show": true
         },
         {
           "format": "short",
           "logBase": 1,
           "show": false
         }
       ],
       "yaxis": {
         "align": false
       }
     }
   ],
   "refresh": "10s",
   "schemaVersion": 39,
   "tags": [
     "mimir"
   ],
   "templating": {
     "list": [
       {
         "current": {
           "selected": true,
           "text": "Mimir (cedi.dev)",
           "value": "mimir-cedi"
         },
         "hide": 0,
         "includeAll": false,
         "label": "Data Source",
         "multi": false,
         "name": "datasource",
         "options": [],
         "query": "prometheus",
         "queryValue": "",
         "refresh": 1,
         "regex": "",
         "skipUrlSync": false,
         "type": "datasource"
       },
       {
         "allValue": ".+",
         "current": {
           "selected": true,
           "text": [
             "All"
           ],
           "value": [
             "$__all"
           ]
         },
         "datasource": {
           "type": "prometheus",
           "uid": "$datasource"
         },
         "definition": "",
         "hide": 0,
         "includeAll": true,
         "label": "cluster",
         "multi": true,
         "name": "cluster",
         "options": [],
         "query": "label_values(cortex_build_info, cluster)",
         "refresh": 1,
         "regex": "",
         "skipUrlSync": false,
         "sort": 2,
         "tagValuesQuery": "",
         "tagsQuery": "",
         "type": "query",
         "useTags": false
       },
       {
         "allValue": ".+",
         "current": {
           "selected": true,
           "text": [
             "All"
           ],
           "value": [
             "$__all"
           ]
         },
         "datasource": {
           "type": "prometheus",
           "uid": "$datasource"
         },
         "definition": "",
         "hide": 0,
         "includeAll": true,
         "label": "namespace",
         "multi": true,
         "name": "namespace",
         "options": [],
         "query": "label_values(cortex_build_info{cluster=~\"$cluster\"}, namespace)",
         "refresh": 1,
         "regex": "",
         "skipUrlSync": false,
         "sort": 2,
         "tagValuesQuery": "",
         "tagsQuery": "",
         "type": "query",
         "useTags": false
       }
     ]
   },
   "time": {
     "from": "now-1h",
     "to": "now"
   },
   "timepicker": {
     "refresh_intervals": [
       "5s",
       "10s",
       "30s",
       "1m",
       "5m",
       "15m",
       "30m",
       "1h",
       "2h",
       "1d"
     ],
     "time_options": [
       "5m",
       "15m",
       "1h",
       "6h",
       "12h",
       "24h",
       "2d",
       "7d",
       "30d"
     ]
   },
   "timezone": "utc",
   "title": "Mimir / Compactor",
   "uid": "1b3443aea86db629e6efdb7d05c53823",
   "version": 1,
   "weekStart": ""
 }